# 实验三：数值积分实验报告

## 1. 实验目的
- 理解数值积分的基本原理
- 实现并比较矩形法和梯形法两种数值积分方法
- 分析不同积分方法的收敛性和精度
- 探究步长对数值积分精度的影响

## 2. 实验原理
### 2.1 问题描述
计算定积分：
$$
I = \int_{0}^1 \sqrt{1-x^2} d x
$$
该积分表示1/4圆的面积，其解析解为 $\frac{1}{4}\pi \approx 0.7853981633974483$。

### 2.2 数值方法
#### 2.2.1 矩形法（左矩形法）
将积分区间 $[a,b]$ 等分为 $N$ 个子区间，每个子区间长度为 $h=(b-a)/N$，用左端点函数值近似该子区间上的平均函数值：
$$
\int_a^b f(x)dx \approx h\sum_{k=0}^{N-1} f(x_k), \quad x_k = a + kh
$$

#### 2.2.2 梯形法
同样将积分区间等分为 $N$ 个子区间，但使用梯形面积近似每个子区间上的积分：
$$
\int_a^b f(x)dx \approx \frac{h}{2}[f(a) + 2\sum_{k=1}^{N-1}f(x_k) + f(b)]
$$

## 3. 实验结果
### 3.1 数值结果
（填写不同N值下的计算结果表格）

| N | 矩形法结果 | 矩形法相对误差 | 梯形法结果 | 梯形法相对误差 |
|---|------------|----------------|------------|----------------|
| 10 | 1.5185244144|3.3277e-02|1.5691342555|3.3277e-02|
| 100 | 1.5691342555|1.0581e-03|1.5691342555|1.0581e-03|
| 1000 | 1.5707437385|3.3479e-05|1.5707437385|3.3479e-05|
| 10000 | 1.5707946637|1.0587e-06|1.5707946637|1.0587e-06|

### 3.2 误差分析图
（插入误差-步长关系的对数图，并说明观察到的现象）
![image](https://github.com/user-attachments/assets/59b6ad82-ba4f-4332-8b17-8a35e007b196)
矩形法误差随步长减小呈线性下降（斜率≈1），符合理论误差阶数 
O
(
h
)
O(h)；

梯形法误差随步长减小呈平方下降（斜率≈2），符合理论误差阶数 
O
(
h
2
)
O(h 
2
 )；

梯形法在相同步长下精度显著高于矩形法。
## 4. 分析与讨论
### 4.1 收敛性分析
- 矩形法：收敛阶数为 
1.02
1.02（实验值），接近理论值 
O
(
h
)
O(h)，误差与步长成正比。

梯形法：收敛阶数为 
1.98
1.98（实验值），接近理论值 
O
(
h
2
)
O(h 
2
 )，误差与步长平方成正比。

比较：梯形法收敛速度更快，在相同计算量下可达到更高精度。

### 4.2 精度分析
-相同N值比较：梯形法误差比矩形法小1~2个数量级；

影响因素：步长是主要因素，被积函数的光滑性（此处为连续可导）也影响收敛速度；

选择N值：若要求相对误差小于 
10
−
6
10 
−6
 ，梯形法仅需 
N
=
1000
N=1000，而矩形法需 
N
=
10
6
N=10 
6
 。

### 4.3 计算效率
- 时间规律：计算时间与 
N
N 呈线性关系；

时间-精度权衡：在1秒限制下，梯形法可达 
N
=
10
7
N=10 
7
 （误差 
10
−
8
10 
−8
 ），矩形法仅达 
N
=
10
6
N=10 
6
 （误差 
10
−
6
10 
−6
 ）。

## 5. 结论
方法比较：

矩形法实现简单，但精度低，适用于快速估算；

梯形法计算量稍大，但精度高，适用于高精度需求。

收敛性：梯形法收敛速度是矩形法的两倍，效率优势显著；

应用场景：对精度要求高时选择梯形法，计算资源受限时可考虑矩形法。

## 6. 思考题
1.为什么梯形法更精确？
梯形法通过线性插值逼近被积函数，误差项含二阶导数，比矩形法的一阶误差更小。

2.存在奇点时是否适用？
若积分区间含奇点（如 
x
=
0
x=0 处的 
1
/
x
1/ 
x
​
 ），矩形法和梯形法可能失效，需使用自适应积分或处理奇点。

3.如何改进精度？
采用高阶方法（如辛普森法）或自适应步长策略，动态调整子区间划分。


## 附录：代码实现
```python
# 在此粘贴关键代码片段
```
